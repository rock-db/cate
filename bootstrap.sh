#!/bin/sh

found=0

for i in gcc clang "zig cc"; do
	if command -v $i > /dev/null 2>&1; then
		cat <<EOF > "Makefile"
# @generated by cmate bootstrap
PROJECT_NAMES := cmate
CC_cmate	:=$i
EOF
		found=1
		break
	fi
done


if [ "$found" -eq 0 ];then
	echo "Error: No valid C compiler was found" >&2
	echo "Supported C compilers: 'gcc' 'clang' 'zig cc'" >&2
	exit 1
fi

cat <<EOF >> "Makefile"
CFLAGS_cmate := -Wall -Wextra -std=c99
LDLIBS_cmate :=
LDFLAGS_cmate :=  -O2  -DDEBUG
SRCDIRS_cmate :=  cmate/src
INCLUDE_DIRS_cmate :=  cmate/include
EXTRA_SOURCES_cmate :=

EOF


cat ./cmate/template/Makefile >> "Makefile"

printf "Bootstrap is \x1b[32mdone\x1b[0m.\n"
printf "You can probably build cmate by just running make.\n"

